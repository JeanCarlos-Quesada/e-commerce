import React from "react";
import { useDispatch, useSelector } from "react-redux";

/*Components*/
import HeaderMenu from "./HeaderMenu/Index";

/*Actions*/
import { getCart } from "../actions/CartActions";
import { Link } from "react-router-dom";

const Header = () => {
  const dispatch = useDispatch();
  const cartList = useSelector((state) => state.cartReducer.list);
  const cartCount = useSelector((state) => state.cartReducer.count);
  const user = useSelector((state) => state.userReducer.user);

  React.useEffect(() => {
    dispatch(getCart());

    window.onscroll = () => {
      var header = document.getElementsByTagName("header")[0];
      var headerPosition = header.offsetTop;

      if (window.pageYOffset > headerPosition) {
        header.style.position = 'fixed'
      } else {
        header.style.position = 'unset'
      }
    };
  }, []);

  return (
    <header>
      <div className='mr-auto'>
        <span className='action-icon'>
          <svg
            width='21'
            height='17'
            viewBox='0 0 21 17'
            fill='none'
            xmlns='http://www.w3.org/2000/svg'
          >
            <path
              d='M20.299 0.477941H5.62745C5.51691 0.477941 5.42647 0.563971 5.42647 0.669118V2.00735C5.42647 2.1125 5.51691 2.19853 5.62745 2.19853H20.299C20.4096 2.19853 20.5 2.1125 20.5 2.00735V0.669118C20.5 0.563971 20.4096 0.477941 20.299 0.477941ZM20.299 7.26471H5.62745C5.51691 7.26471 5.42647 7.35074 5.42647 7.45588V8.79412C5.42647 8.89927 5.51691 8.98529 5.62745 8.98529H20.299C20.4096 8.98529 20.5 8.89927 20.5 8.79412V7.45588C20.5 7.35074 20.4096 7.26471 20.299 7.26471ZM20.299 14.0515H5.62745C5.51691 14.0515 5.42647 14.1375 5.42647 14.2426V15.5809C5.42647 15.686 5.51691 15.7721 5.62745 15.7721H20.299C20.4096 15.7721 20.5 15.686 20.5 15.5809V14.2426C20.5 14.1375 20.4096 14.0515 20.299 14.0515ZM0 1.33824C-2.75302e-09 1.51397 0.0363896 1.68799 0.107091 1.85036C0.177793 2.01272 0.281421 2.16024 0.412061 2.28451C0.5427 2.40878 0.697791 2.50735 0.86848 2.5746C1.03917 2.64186 1.22211 2.67647 1.40686 2.67647C1.59161 2.67647 1.77456 2.64186 1.94525 2.5746C2.11593 2.50735 2.27103 2.40878 2.40166 2.28451C2.5323 2.16024 2.63593 2.01272 2.70663 1.85036C2.77734 1.68799 2.81373 1.51397 2.81373 1.33824C2.81373 1.1625 2.77734 0.988477 2.70663 0.826115C2.63593 0.663753 2.5323 0.516227 2.40166 0.39196C2.27103 0.267693 2.11593 0.16912 1.94525 0.101867C1.77456 0.0346144 1.59161 0 1.40686 0C1.22211 0 1.03917 0.0346144 0.86848 0.101867C0.697791 0.16912 0.5427 0.267693 0.412061 0.39196C0.281421 0.516227 0.177793 0.663753 0.107091 0.826115C0.0363896 0.988477 -2.75302e-09 1.1625 0 1.33824ZM0 8.125C-2.75302e-09 8.30074 0.0363896 8.47476 0.107091 8.63712C0.177793 8.79948 0.281421 8.94701 0.412061 9.07127C0.5427 9.19554 0.697791 9.29412 0.86848 9.36137C1.03917 9.42862 1.22211 9.46324 1.40686 9.46324C1.59161 9.46324 1.77456 9.42862 1.94525 9.36137C2.11593 9.29412 2.27103 9.19554 2.40166 9.07127C2.5323 8.94701 2.63593 8.79948 2.70663 8.63712C2.77734 8.47476 2.81373 8.30074 2.81373 8.125C2.81373 7.94926 2.77734 7.77524 2.70663 7.61288C2.63593 7.45052 2.5323 7.30299 2.40166 7.17872C2.27103 7.05446 2.11593 6.95588 1.94525 6.88863C1.77456 6.82138 1.59161 6.78676 1.40686 6.78676C1.22211 6.78676 1.03917 6.82138 0.86848 6.88863C0.697791 6.95588 0.5427 7.05446 0.412061 7.17872C0.281421 7.30299 0.177793 7.45052 0.107091 7.61288C0.0363896 7.77524 -2.75302e-09 7.94926 0 8.125ZM0 14.9118C-2.75302e-09 15.0875 0.0363896 15.2615 0.107091 15.4239C0.177793 15.5862 0.281421 15.7338 0.412061 15.858C0.5427 15.9823 0.697791 16.0809 0.86848 16.1481C1.03917 16.2154 1.22211 16.25 1.40686 16.25C1.59161 16.25 1.77456 16.2154 1.94525 16.1481C2.11593 16.0809 2.27103 15.9823 2.40166 15.858C2.5323 15.7338 2.63593 15.5862 2.70663 15.4239C2.77734 15.2615 2.81373 15.0875 2.81373 14.9118C2.81373 14.736 2.77734 14.562 2.70663 14.3996C2.63593 14.2373 2.5323 14.0898 2.40166 13.9655C2.27103 13.8412 2.11593 13.7427 1.94525 13.6754C1.77456 13.6081 1.59161 13.5735 1.40686 13.5735C1.22211 13.5735 1.03917 13.6081 0.86848 13.6754C0.697791 13.7427 0.5427 13.8412 0.412061 13.9655C0.281421 14.0898 0.177793 14.2373 0.107091 14.3996C0.0363896 14.562 -2.75302e-09 14.736 0 14.9118Z'
              fill='#333333'
            />
          </svg>
          <HeaderMenu type={"categories"} />
        </span>
        <a href='#logo'>Logo</a>
      </div>
      <div className='ml-auto'>
        {user === undefined && (
          <React.Fragment>
            <Link to={"/Register"}>Register</Link>
            <Link to={"/Login"} className='btn'>
              Login
            </Link>
          </React.Fragment>
        )}
        {user !== undefined && (
          <span className='action-icon'>
            <svg
              width='27'
              height='29'
              viewBox='0 0 27 29'
              fill='none'
              xmlns='http://www.w3.org/2000/svg'
            >
              <path
                d='M25.8037 23.2C25.1299 21.6042 24.1523 20.1547 22.9251 18.9321C21.7016 17.7061 20.2523 16.7286 18.6572 16.0536C18.6429 16.0464 18.6287 16.0429 18.6144 16.0357C20.8394 14.4286 22.2858 11.8107 22.2858 8.85714C22.2858 3.96429 18.3215 0 13.4287 0C8.5358 0 4.57152 3.96429 4.57152 8.85714C4.57152 11.8107 6.01795 14.4286 8.24295 16.0393C8.22866 16.0464 8.21438 16.05 8.20009 16.0571C6.60009 16.7321 5.16438 17.7 3.93223 18.9357C2.70619 20.1592 1.72868 21.6085 1.05366 23.2036C0.390526 24.7652 0.0328819 26.4394 8.93071e-05 28.1357C-0.000863925 28.1738 0.00582189 28.2118 0.019753 28.2472C0.0336841 28.2827 0.0545785 28.3151 0.081205 28.3424C0.107832 28.3697 0.139652 28.3914 0.17479 28.4062C0.209928 28.421 0.247674 28.4286 0.285804 28.4286H2.42866C2.5858 28.4286 2.7108 28.3036 2.71438 28.15C2.7858 25.3929 3.89295 22.8107 5.85009 20.8536C7.87509 18.8286 10.5644 17.7143 13.4287 17.7143C16.2929 17.7143 18.9822 18.8286 21.0072 20.8536C22.9644 22.8107 24.0715 25.3929 24.1429 28.15C24.1465 28.3071 24.2715 28.4286 24.4287 28.4286H26.5715C26.6096 28.4286 26.6474 28.421 26.6825 28.4062C26.7177 28.3914 26.7495 28.3697 26.7761 28.3424C26.8027 28.3151 26.8236 28.2827 26.8376 28.2472C26.8515 28.2118 26.8582 28.1738 26.8572 28.1357C26.8215 26.4286 26.4679 24.7679 25.8037 23.2ZM13.4287 15C11.7894 15 10.2465 14.3607 9.0858 13.2C7.92509 12.0393 7.2858 10.4964 7.2858 8.85714C7.2858 7.21786 7.92509 5.675 9.0858 4.51429C10.2465 3.35357 11.7894 2.71429 13.4287 2.71429C15.0679 2.71429 16.6108 3.35357 17.7715 4.51429C18.9322 5.675 19.5715 7.21786 19.5715 8.85714C19.5715 10.4964 18.9322 12.0393 17.7715 13.2C16.6108 14.3607 15.0679 15 13.4287 15Z'
                fill='#333333'
              />
            </svg>

            <HeaderMenu type={"user"} />
          </span>
        )}
        <Link to={"/Catalog/Cart"} className='action-icon'>
          <span className='cartCount'>
            {cartCount > 99 ? `+99` : cartCount}
          </span>
          <svg
            width='26'
            height='29'
            viewBox='0 0 26 29'
            fill='none'
            xmlns='http://www.w3.org/2000/svg'
          >
            <path
              d='M24 7.14286H19.1429V6.57143C19.1429 2.94286 16.2 0 12.5714 0C8.94286 0 6 2.94286 6 6.57143V7.14286H1.14286C0.510714 7.14286 0 7.65357 0 8.28572V27.4286C0 28.0607 0.510714 28.5714 1.14286 28.5714H24C24.6321 28.5714 25.1429 28.0607 25.1429 27.4286V8.28572C25.1429 7.65357 24.6321 7.14286 24 7.14286ZM8.57143 6.57143C8.57143 4.36071 10.3607 2.57143 12.5714 2.57143C14.7821 2.57143 16.5714 4.36071 16.5714 6.57143V7.14286H8.57143V6.57143ZM22.5714 26H2.57143V9.71429H6V12.8571C6 13.0143 6.12857 13.1429 6.28571 13.1429H8.28572C8.44286 13.1429 8.57143 13.0143 8.57143 12.8571V9.71429H16.5714V12.8571C16.5714 13.0143 16.7 13.1429 16.8571 13.1429H18.8571C19.0143 13.1429 19.1429 13.0143 19.1429 12.8571V9.71429H22.5714V26Z'
              fill='#333333'
            />
          </svg>
        </Link>
      </div>
    </header>
  );
};

export default Header;
